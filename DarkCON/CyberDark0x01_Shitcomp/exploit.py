def divide_file(filename, num):
	src = list(open(filename,"rb").read())
	file = ["" for i in range(num)]
	for i in range(len(src)):
		file[i%num] += chr(src[i])
	return file

def recover(src, cycle):
	res = ""
	for i in range(cycle):
		num = [0 for j in range(0x100)]
		for j in range(i,len(src),cycle):
			num[ord(src[j])] += 1
		x = 0
		for j in range(0x100):
			if num[j]>num[x]:
				x = j
		res += chr(x^0x1)
	print("[+] result: " + res)
	return res

def decompress(key, filename):
	src = list(open(filename+".shitty","rb").read())
	sz = len(key)
	dest = b""
	for i in range(0,len(src),3):
		hi = src[i+1]^ord(key[(i+1)%sz])
		lo = src[i+2]^ord(key[(i+2)%sz])
		c = (src[i]^ord(key[i%sz]))
		dest += bytes([c for _ in range(hi*256+lo)])
	open(filename,"wb").write(dest)

file = divide_file("Installer.shitty",3)

passwd = ["" for i in range(3)]

passwd[1] = "yrrsoGedaaatbDkAoaAInPyCeaIClmnWnlI"

passwd[2] = recover(file[2], len(passwd[1]))

key = ""

for i in range(len(passwd[1])):
	key += "?"
	key += list(passwd[1])[i]
	key += list(passwd[2])[i]

print("[+] key: " + key)

passwd = "CyberDarkIsACoolGameAndIWannaPlayIt"*3

decompress(passwd, "Installer")